# TODO: 찬반 설문조사 플랫폼 개발 태스크

## Phase 1: MVP (4주)

### Week 1: 프로젝트 셋업 & 기본 구조

#### Day 1-2: 환경 구축
- [ ] Cloudflare 계정 설정
  - [ ] Pages 프로젝트 생성
  - [ ] Workers 프로젝트 생성
  - [ ] D1 데이터베이스 생성
  - [ ] KV 네임스페이스 생성
- [ ] Clerk 계정 설정
  - [ ] 프로젝트 생성
  - [ ] 카카오 소셜 로그인 설정
  - [ ] 네이버 소셜 로그인 설정
  - [ ] 구글 소셜 로그인 설정
- [ ] 레포지토리 구조 생성
  - [ ] frontend/ 디렉토리 (Vite + React)
  - [ ] workers/ 디렉토리 (Cloudflare Workers)
  - [ ] docs/ 디렉토리

#### Day 3-4: 데이터베이스 & API 기본
- [ ] D1 스키마 작성 및 마이그레이션
  - [ ] users 테이블
  - [ ] user_profiles 테이블
  - [ ] polls 테이블
  - [ ] responses 테이블
  - [ ] 인덱스 생성
- [ ] Workers 기본 라우터 설정
  - [ ] Hono 또는 itty-router 선택
  - [ ] CORS 미들웨어
  - [ ] 에러 핸들링

#### Day 5: 인증 연동
- [ ] Clerk SDK 설치 (Frontend)
- [ ] Clerk 미들웨어 (Workers)
- [ ] 로그인/로그아웃 플로우
- [ ] 토큰 검증 유틸

---

### Week 2: 핵심 기능 - 설문 & 투표

#### Day 1-2: 설문 등록
- [ ] API: POST /api/polls
  - [ ] 입력 검증 (질문 길이, 옵션 개수)
  - [ ] D1에 저장
  - [ ] KV 초기 카운트 생성
- [ ] Frontend: CreatePoll 컴포넌트
  - [ ] 질문 입력
  - [ ] 옵션 입력 (2~4개)
  - [ ] 카테고리 선택
  - [ ] 마감일 선택 (선택사항)
  - [ ] 등록 버튼

#### Day 3-4: 설문 피드 & 상세
- [ ] API: GET /api/polls
  - [ ] 페이지네이션 (cursor 기반)
  - [ ] 카테고리 필터
  - [ ] 정렬 (최신순, 인기순)
- [ ] API: GET /api/polls/:id
  - [ ] 설문 정보
  - [ ] 결과 포함 (투표 후)
- [ ] Frontend: PollFeed 컴포넌트
  - [ ] 무한 스크롤
  - [ ] 카테고리 탭
- [ ] Frontend: PollCard 컴포넌트
  - [ ] 질문 표시
  - [ ] 옵션 버튼들
  - [ ] 응답 수 표시

#### Day 5: 투표 기능
- [ ] Fingerprint 생성 유틸 (Frontend)
  - [ ] Canvas fingerprint
  - [ ] User agent + screen size
  - [ ] SHA-256 해시
- [ ] API: POST /api/polls/:id/vote
  - [ ] 중복 체크 (fingerprint)
  - [ ] D1에 응답 저장
  - [ ] KV 카운트 업데이트
  - [ ] 결과 반환
- [ ] Frontend: 투표 후 결과 표시
  - [ ] 비율 바 차트
  - [ ] 애니메이션

---

### Week 3: 프로필 & 교차분석

#### Day 1-2: 프로필 관리
- [ ] API: GET /api/users/me
- [ ] API: PUT /api/users/me/profile
  - [ ] 성별, 연령대, 지역 저장
  - [ ] share_* 플래그 저장
- [ ] Frontend: Profile 컴포넌트
  - [ ] 기본 정보 입력
  - [ ] "통계 분석에 제공" 동의 토글
  - [ ] 동의 설명 문구

#### Day 3-4: 교차분석 결과
- [ ] 투표 시 프로필 스냅샷 저장
  - [ ] share 동의한 항목만 responses에 저장
- [ ] 결과 API 확장
  - [ ] byGender 집계
  - [ ] byAgeGroup 집계
  - [ ] 소표본(k명 미만) 제외
- [ ] Frontend: Results 컴포넌트
  - [ ] 전체 결과
  - [ ] 성별별 결과 탭
  - [ ] 연령대별 결과 탭
  - [ ] "내 세그먼트는?" 하이라이트

#### Day 5: 결과 공유
- [ ] 결과 공유 URL 생성
- [ ] 카카오톡 공유 연동
- [ ] 링크 복사 버튼
- [ ] OG 메타태그 설정

---

### Week 4: 마무리 & 배포

#### Day 1-2: UI/UX 개선
- [ ] 반응형 디자인
  - [ ] 모바일 최적화
  - [ ] 스와이프 제스처 (선택)
- [ ] 로딩 상태
  - [ ] 스켈레톤 UI
  - [ ] 투표 중 로딩
- [ ] 에러 처리
  - [ ] 네트워크 에러
  - [ ] 중복 투표 안내
- [ ] 빈 상태
  - [ ] 설문 없음
  - [ ] 검색 결과 없음

#### Day 3: 테스트 & 버그 수정
- [ ] 주요 플로우 테스트
  - [ ] 회원가입 → 프로필 설정 → 투표 → 결과 확인
  - [ ] 설문 등록 → 공유 → 결과 확인
  - [ ] 비로그인 투표
- [ ] 크로스 브라우저 테스트
  - [ ] Chrome
  - [ ] Safari (iOS)
  - [ ] Samsung Internet
- [ ] 버그 수정

#### Day 4: 배포
- [ ] Production 환경 설정
  - [ ] 환경 변수
  - [ ] 도메인 연결
- [ ] Cloudflare Pages 배포
- [ ] Cloudflare Workers 배포
- [ ] D1 프로덕션 마이그레이션
- [ ] 모니터링 설정

#### Day 5: 런칭 준비
- [ ] 시드 콘텐츠 등록 (초기 설문 20개)
- [ ] 랜딩 페이지 문구
- [ ] 개인정보처리방침
- [ ] 이용약관
- [ ] 피드백 수집 채널 (카카오톡 오픈채팅?)

---

## Phase 2: 유료 설문 (4주) - 후속

### Week 5-6: 리워드 시스템
- [ ] 기프티콘 API 연동 (기프티스타/카카오 선물하기)
- [ ] 예치금 시스템
- [ ] 설문당 리워드 설정
- [ ] 리워드 지급 로직
- [ ] 잔액 환불 기능

### Week 7-8: 품질 관리
- [ ] 응답 시간 기반 필터링
- [ ] 주의력 체크 문항
- [ ] 신뢰도 점수 시스템
- [ ] 타겟 설문 (특정 속성만)
- [ ] 휴대폰 본인인증 (선택)

---

## Phase 3: 고급 기능 (4주) - 후속

### 확장 프로필
- [ ] 학력, 직업군 추가
- [ ] 민감정보 (종교, 건강) - 별도 동의
- [ ] 인증 프로필 배지

### 고급 분석
- [ ] 다중 교차분석
- [ ] 시계열 추이
- [ ] 데이터 내보내기 (집계만)
- [ ] API 제공 (B2B)

---

## 기술 부채 / 개선사항

### 성능
- [ ] KV 캐시 최적화
- [ ] 이미지 최적화 (OG 이미지)
- [ ] 번들 사이즈 최적화

### 보안
- [ ] Rate limiting 강화
- [ ] 봇 탐지
- [ ] 보안 감사

### 운영
- [ ] 관리자 대시보드
- [ ] 신고 기능
- [ ] 설문 승인 시스템 (선택)
- [ ] 알림 (신규 응답)

---

## 완료된 항목
<!-- 완료되면 여기로 이동 -->
